{% extends "hello/layout.html" %}

{% block title %}Send Location{% endblock %}

{% block content %}
<h2>Send Phone Location</h2>

<button onclick="sendLocation()">Send Location</button>
<p id="status"></p>
{% endblock %}

{% block extra_js %}
<script>
function sendLocation() {
    navigator.geolocation.getCurrentPosition(
        position => {
            fetch("/api/location/", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    latitude: position.coords.latitude,
                    longitude: position.coords.longitude
                })
            })
            .then(() => {
                document.getElementById("status").innerText = "Location sent!";
            });
        },
        error => {
            document.getElementById("status").innerText =
                "Error getting location: " + error.message;
        }
    );
}
</script>
{% endblock %}
